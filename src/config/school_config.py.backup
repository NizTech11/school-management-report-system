# -*- coding: utf-8 -*-
"""
School Configuration for Report Templates
This file contains all the customizable settings for school reports
"""

import os
from datetime import datetime

class SchoolConfig:
    """Configuration class for school information and report settings"""
    
    # === SCHOOL INFORMATION ===
    SCHOOL_NAME = "BRIGHT KIDS INTERNATIONAL SCHOOL"
    SCHOOL_SUBTITLE = "Excellence in Education"
    SCHOOL_MOTTO = ""  # Optional motto to display
    
    # === CONTACT INFORMATION ===
    ADDRESS = "P.O. Box SC 344, Sekondi"
    EMAIL = "brightkidsint@gmail.com"
    PHONE_NUMBERS = ["0533150076", "0551215664"]  # List of phone numbers
    WEBSITE = ""  # Optional website
    
    # === LOGO SETTINGS ===
    LOGO_PATH = ""  # Path to school logo image (leave empty if no logo)
    LOGO_WIDTH = 60  # Logo width in points
    LOGO_HEIGHT = 60  # Logo height in points
    SHOW_LOGO = False  # Set to True to show logo in reports
    
    # === REPORT SETTINGS ===
    ACADEMIC_YEAR = "2024-2025"  # Current academic year
    CURRENT_TERM = "3RD TERM"  # Current term
    REPORT_FOOTER = "Generated by School Management System"
    
    # === GRADING SYSTEM ===
    GRADE_SYSTEM_NAME = "9-Point Grading Scale"
    
    # Grade remarks (can be customized)
    GRADE_REMARKS = {
        1: "HIGHEST",
        2: "HIGHER", 
        3: "HIGH",
        4: "HIGH AVERAGE",
        5: "AVERAGE",
        6: "LOW AVERAGE",
        7: "LOW",
        8: "LOWER",
        9: "LOWEST"
    }
    
    # === REPORT TITLES ===
    REPORT_TITLES = {
        "Mid-term": "MID-TERM EXAMINATION REPORT",
        "End of Term": "END OF TERM EXAMINATION REPORT", 
        "External": "EXTERNAL EXAMINATION REPORT"
    }
    
    # === COLORS (Professional Theme) ===
    SCHOOL_COLOR = (0.1, 0.2, 0.5)  # RGB values (0-1 range) - School Blue
    ACCENT_COLOR = (1.0, 0.8, 0.0)  # RGB values - Accent Gold
    SUCCESS_COLOR = (0.2, 0.7, 0.3)  # RGB values - Success Green
    
    # === PAGE SETTINGS ===
    PAGE_MARGINS = {
        "top": 40,
        "bottom": 30,
        "left": 45,
        "right": 45
    }
    
    # === FONT SETTINGS ===
    FONTS = {
        "title": {"name": "Helvetica-Bold", "size": 16},
        "subtitle": {"name": "Helvetica", "size": 10},
        "header": {"name": "Helvetica-Bold", "size": 10},
        "body": {"name": "Helvetica", "size": 9},
        "footer": {"name": "Helvetica-Oblique", "size": 7}
    }
    
    @classmethod
    def get_contact_info(cls):
        """Get formatted contact information"""
        contact_parts = []
        
        if cls.EMAIL:
            contact_parts.append(f"üìß {cls.EMAIL}")
            
        if cls.PHONE_NUMBERS:
            phone_str = " / ".join(cls.PHONE_NUMBERS)
            contact_parts.append(f"üìû {phone_str}")
            
        if cls.WEBSITE:
            contact_parts.append(f"üåê {cls.WEBSITE}")
            
        return "  |  ".join(contact_parts)
    
    @classmethod
    def get_report_title(cls, exam_type="End of Term"):
        """Get formatted report title with current year"""
        current_year = datetime.now().year
        base_title = cls.REPORT_TITLES.get(exam_type, "EXAMINATION REPORT")
        return f"{base_title} ({cls.CURRENT_TERM} {current_year})"
    
    @classmethod
    def get_school_colors(cls):
        """Get school colors as ReportLab Color objects"""
        from reportlab.lib import colors
        return {
            'school': colors.Color(*cls.SCHOOL_COLOR),
            'accent': colors.Color(*cls.ACCENT_COLOR), 
            'success': colors.Color(*cls.SUCCESS_COLOR),
            'light_blue': colors.Color(0.85, 0.9, 1.0),
            'light_gray': colors.Color(0.95, 0.95, 0.95),
            'text_gray': colors.Color(0.3, 0.3, 0.3)
        }
    
    @classmethod
    def validate_logo_path(cls):
        """Check if logo file exists"""
        if cls.LOGO_PATH and cls.SHOW_LOGO:
            return os.path.exists(cls.LOGO_PATH)
        return False

# === CONFIGURATION PRESETS ===
# You can create different presets for different schools or campuses

class AlternativeSchoolConfig(SchoolConfig):
    """Alternative configuration - example of how to create different school configs"""
    SCHOOL_NAME = "ALTERNATIVE ACADEMY"
    SCHOOL_SUBTITLE = "Innovation in Learning"
    ADDRESS = "P.O. Box 123, Accra"
    EMAIL = "info@alternativeacademy.edu.gh"
    PHONE_NUMBERS = ["0501234567", "0271234567"]
    SCHOOL_COLOR = (0.0, 0.4, 0.2)  # Green theme
    
# === USAGE INSTRUCTIONS ===
"""
To customize your school reports:

1. Edit the SchoolConfig class above with your school's information
2. Add your school logo by:
   - Placing the image file in a accessible folder
   - Setting LOGO_PATH to the full path of your image
   - Setting SHOW_LOGO = True
3. Customize colors by changing the RGB values (0.0 to 1.0 range)
4. Modify fonts, margins, and other settings as needed
5. Save this file and restart your application

Example logo setup:
LOGO_PATH = "C:/path/to/your/school_logo.png"
SHOW_LOGO = True

Supported image formats: PNG, JPEG, GIF
"""